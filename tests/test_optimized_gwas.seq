from utils import assert_values, assert_approx 

from ..utils.param import *
from ..utils.type_ops import TypeOps
from ..utils.custom_types import SecureValue
from ..mpc.env import MPCEnv
from ..protocol.sequre_gwas import gwas_protocol


def test_optimized_gwas[TP](mpc: MPCEnv[TP]):
    with open('tests/data/output/gwas.txt') as f:
        expected_output = [float(e.strip()) for e in next(f).split(',')]
        gwas_result = mpc.fp.print_fp(gwas_protocol(mpc, True).share)
        if mpc.pid:
            assert_approx('Optimized GWAS', gwas_result, expected_output)
