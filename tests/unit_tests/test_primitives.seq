from ..utils import assert_values

from sequre.utils.param import *
from sequre.utils.primitives import strassen

from sequre.mpc.env import MPCEnv


def test_matmul_of_size[TP](size, modulus):
    a_mat = [[TP(i * j) for j in range(size)] for i in range(size)]
    b_mat = [[TP(i * j) for j in range(size)] for i in range(size)]
    assert_values(
        f'Matrix multiplication of size {size}x{size}',
        strassen(a_mat, b_mat, modulus),
        a_mat.mult(b_mat, modulus))


def test_matmul[TP](modulus):
    test_matmul_of_size[TP](MATMUL_LEAF_SIZE + 1, modulus)
    test_matmul_of_size[TP](100, modulus)


def test_primitives[TP](mpc: MPCEnv[TP], modulus):
    test_matmul[TP](modulus)
    
    print(f'Primitives passed at CP{mpc.pid}!\n')
