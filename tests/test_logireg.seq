from utils import assert_approx 

from sequre.utils.param import *
from sequre.mpc.env import MPCEnv
from ..protocols.logireg import logireg_protocol


def test_logireg[TP](mpc: MPCEnv[TP]):
    with open('tests/data/output/logireg.txt') as f:
        expected_output = [float(e.strip()) for e in next(f).split(' ')]
        logireg_result = mpc.comms.print_fp(logireg_protocol(mpc, True))
        if mpc.pid:
            assert_approx('Logistic regression', logireg_result, expected_output, error=0.02)

    print(f'Logistic regression passed at {mpc.pid}!\n')
