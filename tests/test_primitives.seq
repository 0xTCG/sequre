from utils import assert_values, assert_approx 

from sequre.utils.param import *
from sequre.utils.primitives import strassen

from sequre.mpc.env import MPCEnv


def test_matmul_of_size[TP](size):
    a_mat = [[TP(i * j) for j in range(size)] for i in range(size)]
    b_mat = [[TP(i * j) for j in range(size)] for i in range(size)]
    assert_values(
        f'Matrix multiplication of size {size}x{size}',
        strassen(a_mat, b_mat, BASE_P),
        a_mat.mult(b_mat, BASE_P))


def test_matmul[TP]():
    test_matmul_of_size[TP](MATMUL_LEAF_SIZE + 1)
    test_matmul_of_size[TP](100)


def test_primitives[TP](mpc: MPCEnv[TP]):
    test_matmul[TP]()
    
    print(f'Primitives passed!\n')
