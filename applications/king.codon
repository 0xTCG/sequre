from numpy.create import ones, array

from sequre.attributes import sequre


@sequre
def collective_king_protocol(mpc, data, t):
    het = array([row.count(1) for row in data])
    dot = data * data @ ones(data.cohort_shape, dtype=int).T
    kinship = (data + data) @ data.T - ((dot + dot.T) - het * (2 - 4 * t))
    return kinship > 0
