from ..utils.param import *
from ..utils.type_ops import TypeOps
from sequre import sequre_beaver


@sequre_beaver
def householder(mpc, x):
    xdot = mpc.dot(x, x)
    shift = mpc.sqrt(xdot) * ((x[0] > 0) * 2 - 1)
    v = x.copy()
    v[0] = v[0] + shift
    return  v / mpc.sqrt((xdot + x[0] * shift) * 2)
